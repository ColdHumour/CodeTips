EXCEL TIPS
==========

## 函数

- 返回元素在序列中的位置，当不需要VLOOKUP时用来查行号或者列号很有用

        =MATCH(A1, B1:B10, 0)

- 根据地址相对位置取值，只要有行列偏移量即可，注意计数从0开始

        =OFFSET(A1, 1, 1)  # 等同于 =B2
        =OFFSET(A1, 0, 0)  # 等同于 =A1

- 根据单元格地址字符串取值，其中地址可以用其他公式生成，然后整体可以嵌套在其他用于计算的函数内

        =INDIRECT("A1")  # 等同于 =A1
        =INDIRECT("Sheet1!A1:B10")

- 字符串转日期，如20170101这种，其他情况可以此类推

        =DATE(LEFT(A1, 4), MID(A1, 5, 2), RIGHT(A1, 2))

- 日期转字符串，如2017/1/1，其他情况可以此类推

        =TEXT(A1, "yyyy-mm-dd")

- 字符串双引号

        ="A""B"  # 输出即 A"B

---



## 更改默认设置

主要是字体和字号，由于 Excel 新建文件和新建 sheet 的机制不一样，因此需要修改多个地方。

- 文件 - 选项 - 常规 - 新建工作簿时 - 修改字体和字号到想要的样子

- `Win + R` 输入 `regedit` 打开注册表编辑器，查看 `HKEY_CLASSES_ROOT\.xlsx\Excel.Sheet.12\ShellNew` 项中的 `FileName` 的值

- 打开该文件，`Ctrl + A`，把字体和字号设置成想要的样子，保存

- 如果无法保存，则先复制一份到其他路径下改好，原路径中的文件 `Shift + 右键` 删除，然后把改好的文件重新复制到当前路径下

---



## 加密

另存为 - “保存”按钮左边的“工具”下拉选“常规选项”，然后可以分别设置文件打开的密码和修改的密码

